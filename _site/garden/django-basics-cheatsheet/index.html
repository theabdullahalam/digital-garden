<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="stylesheet" href="/css/base.css"/>
    <link rel="stylesheet" href="/css/note.css"/>
    <link rel="stylesheet" href="."/>
    <title>Django Basics Cheatsheet</title>
    
    <link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png">
    <link rel="manifest" href="/img/site.webmanifest">
    <link rel="mask-icon" href="/img/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <meta name="msapplication-TileColor" content="#00aba9">
    <meta name="msapplication-config" content="/img/browserconfig.xml">
    <meta
    name="theme-color" content="#323232"> 
    <link
    rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
      integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"/> 
    <link rel="stylesheet" href="/css/prism.css">
  </head>
  <body>
    <header>
      <a id="menu-bars">
        <i class="fa-solid fa-bars"></i>
      </a>
      <a href="/" id="title-link">
        <h1>ABDULLAH ALAM</h1>
      </a>
      <div class="social-links">
        <a href="http://twitter.com/theabdullahalam/" class="social-link" target="_blank">
          <span class="text">twitter</span>
          <i class="icon fa-brands fa-twitter"></i>
        </a>
        <a href="http://github.com/theabdullahalam/" class="social-link" target="_blank">
          <span class="text">github</span>
          <i class="icon fa-brands fa-github"></i>
        </a>
        <a href="http://unsplash.com/theabdullahalam/" class="social-link" target="_blank">
          <span class="text">unsplash</span>
          <i class="icon fa-brands fa-unsplash"></i>
        </a>
        <a href="http://sentient-pixels.com/" class="social-link" target="_blank">
          <span class="text">travel</span>
          <i class="icon fa-solid fa-route"></i>
        </a>
        <a href="/garden/contact" class="social-link" target="_blank">
          <span class="text">contact</span>
          <i class="icon fa-solid fa-address-card"></i>
        </a>
      </div>
    </header>
    <section class="sidebar">
      <ul>
        <li>
            <a href="/tags/garden">all</a>
          </li>
        <li>
            <a href="/tags/collections">collections</a>
          </li>
        <li>
            <a href="/tags/poetry">poetry</a>
          </li>
        <li>
            <a href="/tags/photography">photography</a>
          </li>
        <li>
            <a href="/tags/web">web</a>
          </li>
        <li>
            <a href="/tags/internet">internet</a>
          </li>
        <li>
            <a href="/tags/technology">technology</a>
          </li>
        <li>
            <a href="/tags/software">software</a>
          </li>
        <li>
            <a href="/tags/prose">prose</a>
          </li>
        <li>
            <a href="/tags/dev">dev</a>
          </li>
        <li>
            <a href="/tags/social-media">social-media</a>
          </li>
        <li>
            <a href="/tags/nostalgia">nostalgia</a>
          </li>
        <li>
            <a href="/tags/projects">projects</a>
          </li>
        <li>
            <a href="/tags/fiction">fiction</a>
          </li>
        <li>
            <a href="/tags/books">books</a>
          </li>
        <li>
            <a href="/tags/scifi">scifi</a>
          </li>
        <li>
            <a href="/tags/universe">universe</a>
          </li>
        <li>
            <a href="/tags/cheatsheets">cheatsheets</a>
          </li>
        
      </ul>
    </section>
    <main>
      


<p class="last-modified">Last Modified - June 24, 2022</p>
<h1>Django Basics Cheatsheet</h1>
<h2>Using this cheatsheet</h2>
<p>This cheatsheet was built for personal use while learning django. Rather than a generalized list of possible scenarios, example code implementing most common features are listed. I usually pick and choose parts from this sheet when I know exactly what I want and just need the specific syntax.</p>
<p>Since <a href="/">this</a> <a href="/garden/digital-garden">digital garden</a> is a public document, you are welcome to contribute to it on <a href="https://github.com/theabdullahalam/digital-garden/">GitHub</a>.</p>
<h2>Installation</h2>
<pre><code class="language-shell">pip install django
pip install django-ckeditor
</code></pre>
<p>To use with PostGreSQL,</p>
<pre><code class="language-shell">pip install psycopg2
</code></pre>
<h2>Scaffolding</h2>
<h3>Create a Project</h3>
<pre><code class="language-shell">django-admin startproject &lt;project_name&gt;
</code></pre>
<h3>Create an app</h3>
<p>Navigate to the project folder (containing ''manage.py'') and create an app for your project.</p>
<pre><code class="language-shell">cd &lt;project_name&gt;
python manage.py startapp &lt;app_name&gt;
</code></pre>
<h3>Include the app</h3>
<p>In <strong>settings.py,</strong> (suppose the app name is <strong>main</strong>) -</p>
<pre><code class="language-python">INSTALLED_APPS = [
	'main',
	# ...
]
</code></pre>
<h3>settings.py</h3>
<pre><code class="language-python">SECRET_KEY = os.environ.get('SECRET_KEY')
DEBUG = os.environ.get('DEBUG').lower() == 'true'

ALLOWED_HOSTS = [
    '0.0.0.0',
    'localhost',
    '127.0.0.1',
    '&lt;ip-address&gt;',
    '&lt;domain-name&gt;'
]

STATIC_ROOT = os.path.join(BASE_DIR, &quot;static&quot;)
STATIC_URL = '/static/'

MEDIA_ROOT = os.path.join(BASE_DIR, &quot;media&quot;)
MEDIA_URL = '//garden/media/'

CKEDITOR_UPLOAD_PATH = &quot;uploads/&quot;
CKEDITOR_CONFIGS = {
    'default': {
        'toolbar': 'full',
    },
}

INSTALLED_APPS = [
	'ckeditor',
    'ckeditor_uploader',
    'main',
]

# POSTGRES DATABASE
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql_psycopg2',
        'NAME': os.environ.get('DB_NAME'),
        'USER': os.environ.get('DB_USER'),
        'PASSWORD': os.environ.get('DB_PASS'),
        'HOST': os.environ.get('DB_HOST'),
    }
}

LANGUAGE_CODE = 'en-us'

TIME_ZONE =  'Asia/Kolkata'

USE_I18N = True

USE_L10N = True

USE_TZ = True
</code></pre>
<h3>Setup Database</h3>
<pre><code class="language-shell">python manage.py makemigrations
python manage.py migrate
python manage.py createsuperuser
</code></pre>
<h2>Basic Website</h2>
<h3>views.py</h3>
<pre><code class="language-python">from django.shortcuts import render
from django.core.paginator import Paginator
from .models import Post, PostType

def index(request):
    return render(request, 'index.html')

def post(request, slug):
    # FETCH OBJ
    post_obj=Post.objects.get(slug = str(slug))

    # HUMAN FRIENDLY DATE
    hfr_date = post_obj.created.strftime('%e %b %Y')
    post_obj.hfr_date = hfr_date

    # CREATE CONTEXT
    context = {
        'post': post_obj,
    }

    # RETURN
    return render(request, 'post.html', context=context)

def posts(request, pageno=1):
    # FETCH ALL POSTS
    posts = Post.objects.filter(p_type__type_name = typename).exclude(slug='about').order_by('-created', 'title')

    # PAGINATE
    paginator = Paginator(posts, 10)
    page_num = int(pageno)
    page_obj = paginator.get_page(page_num)
    posts = page_obj.object_list

    # HUMAN FRIENDLY DATE
    for post in posts:
        hfr_date = post.created.strftime('%e %b %Y')
        post.hfr_date = hfr_date

        post.preview = str(post.content).split('&lt;/p&gt;')[0].split('&lt;p&gt;')[1]

    # SET CONTEXT
    context = {
        'posts': posts,
        'pageinator': paginator,
        'page_obj': page_obj,
    }

    # RETURN
    return render(request, 'postlist.html', context=context)

</code></pre>
<h3>App urls.py</h3>
<pre><code class="language-python">from django.urls import path
from . import views
 
urlpatterns = [

    path('', views.index, name='index'),

    path('post/&lt;slug:slug&gt;', views.post, name='post'),
    path('posts', views.posts, name='posts'),
    path('posts/', views.posts, name='posts'),
    path('posts/page/&lt;int:pageno&gt;', views.posts, name='posts'),

]
</code></pre>
<h3>Project urls.py</h3>
<pre><code class="language-python">from django.contrib import admin
from django.urls import path, include
from django.conf import settings
from django.conf.urls.static import static
from django.conf.urls import url
 
urlpatterns = [
    path('admin/', admin.site.urls),
    path('', include('main.urls')),
    url(r'^ckeditor/', include('ckeditor_uploader.urls')),
] + static(
    settings.STATIC_URL,
    document_root=settings.STATIC_ROOT
) + static(
    settings.MEDIA_URL,
    document_root=settings.MEDIA_ROOT
)
</code></pre>
<h2>models.py</h2>
<h3>Basic Structure</h3>
<pre><code class="language-python">from django.db import models
from django.utils import timezone
from ckeditor_uploader.fields import RichTextUploadingField
from django.utils.text import slugify
 
class PostType(models.Model):
    type_name = models.CharField(max_length=30)

    def __str__(self):
        return str(self.type_name)
 
class Post(models.Model):
    image_file = models.ImageField(upload_to='photographs')
    title = models.CharField(max_length=250)
    p_type=models.ForeignKey(PostType, on_delete=models.CASCADE)
    content = RichTextUploadingField(max_length=14000)
    created = models.DateTimeField(editable=False)
    modified = models.DateTimeField(editable=False)
    slug = models.SlugField(unique=True, max_length=100, blank=True)

    def save(self, *args, **kwargs):
        # UPDATE TIMESTAMPS
        if not self.id:
            self.created = timezone.now()
        self.modified = timezone.now()

        # GENERATE SLUG
        if not self.slug:
            self.slug = slugify(self.title)
        return super(Post, self).save(*args, **kwargs)

    def __str__(self):
        return str(self.title)

    class Meta:
        verbose_name = 'Post'
        verbose_name_plural = 'Posts'

</code></pre>
<h3>Many to Many Relation</h3>
<p>Note that the ''ManyToManyField'' is only defined in one model. It doesn't matter which model has the field, but if in doubt, it should be in the model that will be interacted with in a form.</p>
<pre><code class="language-python">class Topping(models.Model):
    # ...
    pass

class Pizza(models.Model):
    # ...
    toppings = models.ManyToManyField(Topping)
</code></pre>
<h3>ImageField Access Examples</h3>
<pre><code class="language-python">car = Car.objects.get(name=&quot;57 Chevy&quot;)
car.photo
::::::&lt;ImageFieldFile: cars/chevy.jpg&gt;
car.photo.name
::::::'cars/chevy.jpg'
car.photo.path
::::::'//garden/media/cars/chevy.jpg'
car.photo.url
::::::'http://media.example.com/cars/chevy.jpg'
</code></pre>
<h2>Django Admin</h2>
<h3>To create ''superuser''</h3>
<pre><code class="language-shell">python manage.py createsuperuser
</code></pre>
<h3>admin.py</h3>
<pre><code class="language-python">from django.contrib import admin
from .models import Post, PostType

@admin.register(PostType)
class PostTypeAdmin(admin.ModelAdmin):
    list_display = ('type_name',)
    ordering = ('type_name',)
    search_fields = ('type_name',)

@admin.register(Post)
class PostAdmin(admin.ModelAdmin):
    list_display = ('title', 'p_type')
    ordering = ('title',)
    search_fields = ('title', 'p_type',)
</code></pre>



  <h1 class="related">Related</h1>
  
    
  
    
      <h2>
        tag: software
      </h2>
      <ul>
        
          
            <li>
              <a href="/garden/is-software-getting-too-abstract/">Is Software Getting too Abstract?</a> 
            </li>
          
        
          
            <li>
              <a href="/garden/django/">Django Cheatsheet</a> 
            </li>
          
        
          
        
      </ul>
    
  
    
  

    </main>
    <script defer>
      function toggleSideBar(e) {
        e.preventDefault()
        const sidebar = document.getElementsByClassName("sidebar")[0];
        sidebar.classList.toggle("visible");
      }
      const menubutton = document.getElementById("menu-bars")
      menubutton.addEventListener("click", toggleSideBar)
    </script>
    
    
    <script src="/js/prism.js"></script>
  </body>
</html>